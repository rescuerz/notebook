# 14. Parallel Algorithm

1. æŒ‡ä»¤çº§å¹¶è¡Œï¼ˆInstruction-Level Parallelismï¼ŒILPï¼‰ï¼šåœ¨ä¸€ä¸ªCPU å†…éƒ¨ï¼Œå¤šæ¡æŒ‡ä»¤å¯ä»¥åŒæ—¶æ‰§è¡Œï¼›ä¾‹å¦‚å¤§å®¶ç°åœ¨å°±å·²ç»å­¦è¿‡çš„æµæ°´çº¿CPUï¼Œä»¥åŠå°†æ¥å¯èƒ½ä¼šå­¦åˆ°çš„ä¹±åºã€å¤šå‘å°„ä»¥åŠè¶…é•¿æŒ‡ä»¤å­—ï¼ˆVLIWï¼Œå³æŠŠä¸ç›¸å…³çš„æŒ‡ä»¤å°è£…åˆ°ä¸€æ¡è¶…é•¿çš„æŒ‡ä»¤å­—ä¸­ã€è¶…æ ‡é‡ï¼ˆä¾‹å¦‚æœ‰å¤šä¸ªALUï¼Œå¯ä»¥åŒæ—¶è¿è¡Œæ²¡æœ‰ç›¸å…³æ€§çš„å¤šæ¡æŒ‡ä»¤ï¼‰ç­‰ï¼›

2. æ•°æ®çº§å¹¶è¡Œï¼ˆData-Level Parallelismï¼ŒDLPï¼‰ï¼šå³å°†ç›¸åŒçš„æ“ä½œåŒæ—¶åº”ç”¨äºä¸€äº›æ•°æ®é¡¹çš„ç¼–ç¨‹æ¨¡å‹ï¼Œä¾‹å¦‚ç»å…¸çš„SIMDï¼ˆSingle Instruction, Multiple Dataï¼‰æ¶æ„ï¼Œå³ä¸€æ¡æŒ‡ä»¤åŒæ—¶ä½œç”¨äºå¤šä¸ªæ•°æ®ï¼Œä¾‹å¦‚ç”¨ä¸€æ¡æŒ‡ä»¤å®ç°å‘é‡åŠ æ³•ï¼Œä¸¤ä¸ªå‘é‡ä¸­æ¯å¯¹å¯¹åº”çš„å…ƒç´ ç›¸åŠ äº’ä¸å¹²æ‰°ï¼Œæ‰€ä»¥å¯ä»¥åŒæ—¶è¿›è¡Œæ‰€æœ‰çš„åŠ æ³•ï¼›
3. çº¿ç¨‹çº§å¹¶è¡Œï¼ˆThread-Level Parallelismï¼ŒTLPï¼‰ï¼šä¸€ç§æ˜¾å¼å¹¶è¡Œï¼Œç¨‹åºå‘˜è¦è®¾è®¡å¹¶è¡Œç®—æ³•ï¼Œå†™å¤šçº¿ç¨‹ç¨‹åºï¼Œè¿™ä¹Ÿæ˜¯æœ¬è®²å°†è¦è®¨è®ºçš„å†…å®¹ã€‚çº¿ç¨‹çº§å¹¶è¡Œä¸»è¦æŒ‡åŒæ—¶å¤šçº¿ç¨‹ï¼ˆSMTï¼Œæ˜¯ä¸€ç§æŒ‡ä»¤çº§å¹¶è¡Œçš„åŸºç¡€ä¸Šçš„æ‰©å±•ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªæ ¸ä¸Šè¿è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œå¤šä¸ªçº¿ç¨‹å…±äº«æ‰§è¡Œå•å…ƒï¼Œä»¥ä¾¿æé«˜éƒ¨ä»¶çš„åˆ©ç”¨ç‡ï¼Œæé«˜ååé‡ï¼‰/è¶…çº¿ç¨‹ï¼ˆHTï¼Œä¸€ä¸ªç‰©ç†CPU æ ¸å¿ƒè¢«ä¼ªè£…æˆä¸¤ä¸ªä»¥ä¸Šçš„é€»è¾‘CPU æ ¸å¿ƒï¼Œçœ‹èµ·æ¥å°±åƒå¤šä¸ªCPU åœ¨åŒæ—¶æ‰§è¡Œä»»åŠ¡ï¼Œæ˜¯é€šè¿‡åœ¨ä¸€ä¸ªç‰©ç†æ ¸å¿ƒä¸­åˆ›å»ºå¤šä¸ªçº¿ç¨‹å®ç°çš„ï¼‰ä»¥åŠå¤šæ ¸å’Œå¤šå¤„ç†å™¨ã€‚

## 14.1 å¹¶è¡Œç®—æ³•åŸºæœ¬æ¨¡å‹

**`å®šä¹‰`** åŠ é€Ÿæ¯”ï¼ˆSpeedupï¼‰æ˜¯æŒ‡åœ¨å¹¶è¡Œè®¡ç®—ä¸­ï¼Œä½¿ç”¨p ä¸ªå¤„ç†å™¨æ—¶ç›¸å¯¹äºä½¿ç”¨ä¸€ä¸ªå¤„ç†å™¨æ—¶çš„æ€§èƒ½æå‡æ¯”ä¾‹ï¼Œå³
$$
S(p) = \dfrac{T_1}{T_p}
$$
å…¶ä¸­$T1$æ˜¯ä½¿ç”¨ä¸€ä¸ªå¤„ç†å™¨æ—¶çš„è¿è¡Œæ—¶é—´ï¼Œ$Tp$æ˜¯ä½¿ç”¨$p$ä¸ªå¤„ç†å™¨æ—¶çš„è¿è¡Œæ—¶é—´ã€‚

æ˜¾ç„¶æœ€ç†æƒ³çš„æƒ…å†µä¸‹ï¼ŒåŠ é€Ÿæ¯”åº”å½“æ˜¯pï¼Œå³ä½¿ç”¨p ä¸ªå¤„ç†å™¨æ—¶çš„è¿è¡Œæ—¶é—´æ˜¯ä½¿ç”¨ä¸€ä¸ªå¤„ç†å™¨æ—¶çš„1/pã€‚ç„¶è€Œå®é™…æƒ…å†µä¸­ï¼Œç”±äºå¹¶è¡Œç®—æ³•çš„è®¾è®¡å’Œå®ç°éƒ½æœ‰ä¸€å®šçš„å›°éš¾ï¼š

- é¦–å…ˆï¼Œä½¿ç”¨å¤šä¸ªå¤„ç†å™¨æ„å‘³ç€é¢å¤–çš„é€šä¿¡å¼€é”€ï¼›
- å…¶æ¬¡ï¼Œå¦‚æœå¤„ç†å™¨å¹¶æœªåˆ†é…åˆ°å®Œå…¨ç›¸åŒçš„å·¥ä½œé‡ï¼Œåˆ™ä¼šäº§ç”Ÿä¸€éƒ¨åˆ†çš„é—²ç½®ï¼Œå°±ä¼šé€ æˆè´Ÿè½½ä¸å‡è¡¡ï¼ˆload unbalanceï¼‰ï¼Œå†æ¬¡é™ä½å®é™…é€Ÿåº¦ï¼›
- æœ€åï¼Œä»£ç è¿è¡Œå¯èƒ½ä¾èµ–å…¶åŸæœ‰é¡ºåºï¼Œä¸èƒ½å®Œå…¨å¹¶è¡Œã€‚



ä¸Šè¿°çŸ©é˜µç›¸ä¹˜å¹¶è¡Œç®—æ³•å¯èƒ½æœ‰å¾ˆå¤šä¸ªCPU åŒæ—¶è®¿é—®äº†åŸå§‹çŸ©é˜µçš„åŒä¸€ä¸ªå…ƒç´ ï¼Œæ¯”å¦‚åŒæ—¶å¾—åˆ°C çš„ç¬¬ä¸€è¡Œçš„æ‰€æœ‰å…ƒç´ éœ€è¦åŒæ—¶è®¿é—®A çš„ç¬¬ä¸€è¡Œçš„æ‰€æœ‰å…ƒç´ ã€‚äº‹å®ä¸Šï¼Œ**`è¿™ç§ç®—æ³•æ¨¡å‹è¢«ç§°ä¸ºPRAM æ¨¡å‹ï¼ˆParallel Random Access Machineï¼‰ï¼Œæ˜¯RAM æ¨¡å‹ï¼ˆRandom Access Machineï¼‰åœ¨å…±äº«å†…å­˜ç³»ç»Ÿä¸Šçš„æ‰©å±•`**ã€‚è¯¥æ¨¡å‹å‡è®¾æ‰€æœ‰å¤„ç†å™¨å…±äº«ä¸€ä¸ªè¿ç»­çš„å†…å­˜ç©ºé—´ã€‚æ­¤å¤–ï¼Œæ¨¡å‹è¿˜å…è®¸åŒä¸€ä½ç½®ä¸ŠåŒæ—¶è¿›è¡Œå¤šä¸ªè®¿é—®ã€‚è¿™åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨æ‰©å¤§é—®é¢˜è§„æ¨¡å’Œå¤„ç†å™¨æ•°é‡çš„æƒ…å†µä¸‹æ˜¯ä¸å¯èƒ½çš„ã€‚å¯¹PRAM æ¨¡å‹çš„å¦ä¸€ä¸ªåå¯¹æ„è§æ˜¯ï¼Œå³ä½¿åœ¨å•ä¸ªå¤„ç†å™¨ä¸Šï¼Œå®ƒä¹Ÿå¿½ç•¥äº†å†…å­˜çš„å±‚æ¬¡ç»“æ„ï¼ˆå³å¿½ç•¥äº†cache ç­‰ï¼‰ã€‚ä½†åœ¨æˆ‘ä»¬æ¥ä¸‹æ¥çš„ç†è®ºè®¨è®ºä¸­ï¼Œæˆ‘ä»¬å¿½ç•¥è¿™äº›é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç›®çš„æ˜¯è®¨è®ºå¹¶è¡Œç®—æ³•çš„åŸºæœ¬æ€æƒ³ã€‚æˆ‘ä»¬ä½¿ç”¨PRAM æ¨¡å‹ï¼Œè¿™ä¸€æ¨¡å‹æœ‰è§„å®šå¦‚ä¸‹ä¸‰ç§å†…å­˜å…±äº«æ–¹å¼ï¼š

1. EREWï¼ˆExclusive Read Exclusive Writeï¼‰ï¼š**æ¯ä¸ªå†…å­˜ä½ç½®åœ¨ä»»æ„æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªå¤„ç†å™¨è¯»å–æˆ–å†™å…¥**ï¼›
2. CREWï¼ˆConcurrent Read Exclusive Writeï¼‰ï¼š**æ¯ä¸ªå†…å­˜ä½ç½®åœ¨ä»»æ„æ—¶åˆ»å¯ä»¥è¢«å¤šä¸ªå¤„ç†å™¨è¯»å–ï¼Œä½†åªèƒ½è¢«ä¸€ä¸ªå¤„ç†å™¨å†™å…¥**ï¼›
3. CRCWï¼ˆConcurrent Read Concurrent Writeï¼‰ï¼š**æ¯ä¸ªå†…å­˜ä½ç½®åœ¨ä»»æ„æ—¶åˆ»å¯ä»¥è¢«å¤šä¸ªå¤„ç†å™¨è¯»å–æˆ–å†™å…¥**ï¼Œå› ä¸ºå†™å…¥æ¶‰åŠåˆ°åŒæ—¶å†™å…¥ä¸åŒå€¼å¯èƒ½é€ æˆçš„å†²çªï¼Œå› æ­¤å†™å…¥ç­–ç•¥åˆå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹ä¸‰ç§ï¼š

(a) `CRCW-Cï¼ˆCommonï¼‰`ï¼šæ‰€æœ‰å¤„ç†å™¨å†™å…¥çš„å€¼ç›¸åŒæ—¶æ‰ä¼šå†™å…¥ï¼›
(b) `CRCW-Aï¼ˆArbitraryï¼‰`ï¼šæ‰€æœ‰å¤„ç†å™¨å†™å…¥çš„å€¼å¯ä»¥ä¸åŒï¼Œä»»æ„é€‰å–å…¶ä¸­ä¸€ä¸ªå†™å…¥å³å¯ï¼›
(c)` CRCW-Pï¼ˆPriorityï¼‰`ï¼šæ‰€æœ‰å¤„ç†å™¨å†™å…¥çš„å€¼å¯ä»¥ä¸åŒï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªä¼˜å…ˆçº§ï¼Œåªæœ‰ä¼˜å…ˆçº§æœ€é«˜çš„å†™å…¥æ‰ä¼šç”Ÿæ•ˆã€‚

## 14.2 The Summation Problem

![image-20240527102310349](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271023410.png)

```cpp
 for (s=2; s<2*n; s*=2)
      for (i=0; i<n-s/2; i+=s)
        x[i] += x[i+s/2]
```

![img](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271025980.webp)

![image-20240527102615828](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271026883.png)

**`éšç€hçš„å¢åŠ ï¼Œéœ€è¦ä½¿ç”¨çš„å¤„ç†å™¨çš„æ•°é‡é€æ¸å‡å°‘ã€‚ä½†æ˜¯åˆä¸ºæ¯ä¸€ä¸ªprocessoråˆ†é…äº†ä»»åŠ¡ï¼ˆstay idleï¼‰ï¼Œè¿™æ˜¯ä¸å¿…è¦çš„`**

> **`æ”¹è¿›`**

![image-20240527103209122](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271032183.png)

`pardo`è¡¨ç¤ºä¸æŒ‡å®šè¿è¡Œçš„processorï¼Œç”±ç¼–è¯‘å™¨è‡ªè¡Œå†³å®šä»»åŠ¡çš„åˆ†é…ã€‚ä½¿ç”¨çš„å¯„å­˜å™¨çš„æ•°é‡ä¹Ÿéšä¹‹å‡å°‘

> **`Measuring the performance`**

- **Work load â€“ total number of operations: W(n)**

- **Worst-case running time: T(n)**
  - **W(n) operations and T(n) time**
  - **P(n) = W(n)/T(n) processors and T(n) time (on a PRAM)**
  - **W(n)/p time using any number of p â‰¤ W(n)/T(n) processors (on a PRAM)**
  - **W(n)/p + T(n) time using any number of p processors (on a PRAM)**

**`è®¡ç®—nä¸ªæ•°çš„å’Œé—®é¢˜ä¸­ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(log N),å¦‚æœç»™å®šçš„å¤„ç†å™¨æ•°é‡ä¸ºn/2ï¼Œä¼šä½¿å¾—æœ€åº•å±‚çš„è¿ç®—æ¬¡æ•°åŠ ä¸€ï¼Œäºæ˜¯T'(n) = T(n) + 1`**

> **`å®šç†ï¼šè®¾ä¸€ä¸ªå¹¶è¡Œè®¡ç®—é—®é¢˜çš„å·¥ä½œé‡ä¸ºWï¼Œå…³é”®è·¯å¾„é•¿åº¦ä¸ºDï¼Œé‚£ä¹ˆä½¿ç”¨pä¸ªå¤„ç†å™¨çš„å¹¶è¡Œæ—¶é—´å…·æœ‰å¦‚ä¸‹ä¸Šä¸‹ç•Œï¼š`**
>$$
> \dfrac{W}{p} \leq T_p \leq \dfrac{W-D}{p} + D
>$$
> ä¸‹ç•Œæ˜¯æ˜¾ç„¶çš„ï¼Œå—åˆ°ç†æƒ³åŠ é€Ÿæ¯”çš„é™åˆ¶
>
> å¯¹äºä¸Šç•Œï¼Œå› ä¸ºå…³é”®è·¯å¾„çš„é•¿åº¦ä¸ºDï¼Œç®—æ³•çš„æ‰§è¡Œå¯ä»¥åˆ†ä¸ºDä¸ªå†…éƒ¨å¹¶è¡Œï¼Œäº’ç›¸ä¹‹é—´ä¸²è¡Œçš„é˜¶æ®µï¼Œæ¯ä¸€ä¸ªé˜¶æ®µçš„å·¥ä½œé‡ä¸º$W_i$,$W = \underset{i = 1}{\sum}W_i$
>
> ä½¿ç”¨p ä¸ªå¤„ç†å™¨æ—¶ï¼Œæ¯ä¸€ä¸ªé˜¶æ®µæ‰€éœ€çš„æ—¶é—´ä¸ºdWi/peï¼Œå‘ä¸Šå–æ•´çš„åŸå› åœ¨äºï¼Œæ¯ä¸ªé˜¶æ®µçš„å·¥ä½œé‡å¯èƒ½ä¸èƒ½è¢«p æ•´é™¤ï¼Œæ¯”å¦‚å¤§ä»»åŠ¡è¢«åˆ†æˆäº†7 ä¸ªå­ä»»åŠ¡ï¼Œ7 ä¸ªä»»åŠ¡åˆ†é…ç»™3 ä¸ªå¤„ç†å™¨ï¼Œé‚£ä¹ˆæ¯ä¸ªå¤„ç†å™¨åˆ†é…åˆ°çš„ä»»åŠ¡æ•°åº”å½“æ˜¯2ï¼Œ2ï¼Œ3ã€‚
>
> éœ€è¦çš„æ€»æ—¶é—´ä¸ºï¼š
>$$
> T_p = \sum_{i=1}^D \lceil \dfrac{W_i}{p}\rceil= \sum_{i=1}^D \lceil \dfrac{W_i - 1}{p}\rceil + 1 \leq \sum_{i=1}^D  \dfrac{W_i - 1}{p} + 1 =\dfrac{W-D}{p}+D
>$$
> 

**ä¸´ç•ŒçŠ¶æ€ï¼Œå¤„ç†å™¨çš„æ•°ç›®å˜ä¸ºn/log n**

![image-20240527104620123](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271046184.png)

> **çŸ©é˜µä¹˜æ³•ï¼šä¸¤ä¸ªné˜¶æ–¹é˜µAå’ŒBç›¸ä¹˜å¾—åˆ°çŸ©é˜µCï¼Œæ˜¾ç„¶æ€»çš„æ“ä½œæ•°æ˜¯2$n^3$(ä¹˜æ³•å’ŒåŠ æ³•)ï¼Œå¦‚æœæˆ‘ä»¬æœ‰$n^2$ä¸ªå¤„ç†å™¨ï¼Œå¯ä»¥è®©æ¯ä¸€ä¸ªå¤„ç†å™¨è´Ÿè´£ç»“æœçŸ©é˜µCçš„ä¸€ä¸ªå…ƒç´ çš„è®¡ç®—ã€‚è¿™æ ·å¹¶è¡Œè®¡ç®—éœ€è¦çš„æ—¶é—´å°±æ˜¯è®¡ç®—ä¸€ä¸ªå…ƒç´ çš„æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯$2n$**
>
> **ç°åœ¨æä¾›æ›´å¤šçš„å¤„ç†å™¨ï¼Œç”¨äºåŠ é€Ÿnä¸ªå¯¹åº”å…ƒç´ ä¹˜æ³•çš„å’Œï¼Œåˆ©ç”¨ä¸Šé¢æåˆ°çš„ç®—æ³•ï¼Œé¢å¤–æä¾›n/2ä¸ªå¤„ç†å™¨ï¼ŒåŠ æ³•çš„æ—¶é—´å¤æ‚åº¦ä¼šä»O(n)ä¸‹é™åˆ°O(logN)**

****

## 14.3 Prefix-Sums

![image-20240527110214946](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271102989.png)

æˆ‘ä»¬å¯ä»¥ä»ä¸Šå¾€ä¸‹è®¡ç®—è¿™ä¸ªCï¼Œæ¯ä¸€å±‚è®¡ç®—éƒ½å¯ä»¥å¹¶è¡Œï¼Œç›´åˆ°ç®—å®ŒC(0, i) å®é™…ä¸Šå°±æ˜¯1 åˆ°i çš„å‰ç¼€å’Œã€‚å› æ­¤å…³é”®å°±æ˜¯æ€ä¹ˆä»ä¸Šå¾€ä¸‹è®¡ç®—ï¼Œå¹¶ä¸”ä¿è¯æ¯ä¸€å±‚éƒ½èƒ½å¹¶è¡Œ

**`B(h,i)è®°å½•çš„æ˜¯summation problemè®°å½•çš„å€¼ï¼Œä¸å‰ç¼€å’Œé—®é¢˜å­˜åœ¨ç€é‡åˆä¹‹å¤„`**

> **`C(h,i)è¡¨ç¤ºå‰2^h * iä¸ªç‚¹çš„å’Œ`**

- **`å¦‚æœi=1ï¼Œé‚£ä¹ˆC(h,i) = B(h,i).å› ä¸ºi=1æ—¶ï¼Œæ ¹æ®å®šä¹‰ï¼ŒC(h,i)ç­‰äºä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹åŠ åˆ°è¯¥ç‚¹ä¸ºæ ¹ç»“ç‚¹çš„å³å­æ ‘çš„å³ä¸‹è§’å¶å­ã€‚æ‰€ä»¥ä¸¤è€…ç›¸ç­‰`**
- **`å¦‚æœiæ˜¯å¶æ•°ï¼Œè¿™è¡¨æ˜è¿™ä¸€ç‚¹æ˜¯æŸä¸ªç‚¹çš„å³å„¿å­ï¼Œå› æ­¤å®ƒå’Œå®ƒçš„çˆ¶äº²çš„æœ€å³ä¸‹è§’çš„å¶å­æ˜¯åŒä¸€ä¸ªï¼Œå› æ­¤æœ‰C(h,i) = C(h+1,i/2)`**
- **`å¦‚æœiæ˜¯å¥‡æ•°ä¸”ä¸æ˜¯1ï¼Œè¿™è¡¨æ˜è¯¥ç‚¹æ˜¯æŸä¸€ä¸ªç‚¹çš„å·¦å„¿å­ï¼Œé¦–å…ˆå®ƒè‡ªå·±çš„å€¼B(h, i) ä¸æ˜¯ä»1 å¼€å§‹åŠ çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é€‰ä¸€ä¸ªå·¦è¾¹çš„ç‚¹ï¼ŒæŠŠä»1å¼€å§‹åŠ åˆ°è¿™ä¸ªç‚¹å¯¹åº”çš„ä¹‹å‰çš„éƒ¨åˆ†è¡¥ä¸Šã€‚æ‰€ä»¥C(h,i) = C(h+1,(i-1)/2) + B(h,i).`**

![image-20240527110234942](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271102028.png)

æ˜¾ç„¶è¿™ä¸€å¹¶è¡Œç®—æ³•çš„**æ·±åº¦æ˜¯O(log n)ï¼Œæ€»å·¥ä½œé‡æ˜¯O(n)**ï¼Œå› ä¸ºæ— éå°±æ˜¯åœ¨å®Œå…¨äºŒå‰æ ‘ä¸Šå…ˆä»ä¸‹å¾€ä¸Šï¼Œç„¶åå†ä»ä¸Šå¾€ä¸‹åˆ†å±‚éå†äº†ä¸¤è½®ã€‚

## 14.4 Merge

![image-20240527111556042](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271115117.png)

**`å…³é”®åœ¨äºæ±‚å‡ºAå…ƒç´ åœ¨Bä¸­çš„æ’åºæˆ–è€…Bå…ƒç´ åœ¨Aä¸­çš„æ’åº`**

![image-20240527111701941](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271117017.png)

![image-20240527111917893](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271119925.png)

Binary Search:**`åœ¨nä¸ªå¤„ç†å™¨çš„åŸºç¡€ä¸Šï¼Œè®¡ç®—æ’åºæ‰€éœ€çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(log n),å¦‚æœæ˜¯å•ä¸ªå¤„ç†å™¨ï¼Œæ‰€éœ€çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(nlog n)`**

**ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ°ä¸€ä¸ªå…ƒç´ åœ¨å¦ä¸€ä¸ªæ•°ç»„ä¸­çš„ä½ç½®åªéœ€è¦O(logN)çš„æ—¶é—´ï¼Œå³æ·±åº¦D=O(logN),æ€»å·¥ä½œé‡ä¸ºO(nlogn),ç„¶åæˆ‘ä»¬éœ€è¦å°†å…ƒç´ æ”¾åˆ°æ­£ç¡®çš„ä½ç½®ä¸Šï¼Œè¿™ä¸€æ·±åº¦ä¸ºO(1),æ€»å·¥ä½œé‡ä¸ºO(n),ä¸¤æ­¥åˆåœ¨ä¸€èµ·æ·±åº¦å°±æ˜¯O(logn),æ€»å·¥ä½œé‡ä¸ºO(nlogn)**

Serial Ranking: 

ä¸¤ä¸ªæ•°ç»„çš„å…ƒç´ ä»å¤´ä¾æ¬¡å‘åæ¯”è¾ƒ

> Binary Searchæ‰€éœ€çš„æ—¶é—´æ›´å°‘ï¼ŒSerial Rankingæ‰€éœ€çš„æ“ä½œæ•°é‡æ›´å°
>
> **`æ”¹è¿›ï¼šParallel Ranking ä½¿ç”¨åˆ’åˆ†èŒƒå¼çš„æ–¹æ³•`**

![image-20240527112958744](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271129791.png)

å‡è®¾æ¯ä¸€æ®µçš„é•¿åº¦ä¸ºlog nï¼Œé‚£ä¹ˆèƒ½å¤Ÿåˆ†æˆ n/log næ®µ

å…ˆå¯¹æ¯ä¸€æ®µçš„æ®µå¤´è¿›è¡Œæ’åº

å†åªéœ€è¦ä¿è¯æ®µå¤´ä¹‹é—´çš„ç»“ç‚¹æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆCå°±æ˜¯æœ‰åºçš„

1. **`åˆ’åˆ†ï¼šæˆ‘ä»¬å°†æ•°ç»„åˆ’åˆ†ä¸ºpä»½ï¼ˆæ­¤æ—¶pæœªçŸ¥ï¼Œéœ€è¦ç»è¿‡åˆ†æé€‰å–åˆ°æœ€ä¼˜çš„pï¼‰ã€‚æˆ‘ä»¬é¦–å…ˆå¯¹æ¯ä¸€ä¸ªå­é—®é¢˜çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ±‚å‡ºå®ƒåœ¨å¦ä¸€ä¸ªæ•°ç»„ä¸­çš„ä½ç½®ï¼Œä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾è€Œéçº¿æ€§æœç´¢ï¼Œæ·±åº¦ä¸ºO(logn),æ€»å·¥ä½œé‡ä¸ºO(plogn)`**

2. **`çœŸå®å·¥ä½œï¼šå‰©ä¸‹çš„å·¥ä½œå°±æ˜¯ç›¸é‚»ä¸¤ä¸ªç®­å¤´ä¹‹é—´çš„éƒ¨åˆ†éœ€è¦åœ¨æœ€ç»ˆæ•°ç»„ä¸­ç¡®å®šç›¸å¯¹ä½ç½®ã€‚ç›¸é‚»çš„ä¸¤ä¸ªç®­å¤´çš„è·ç¦»ä¸ä¼šè¶…è¿‡n/pï¼Œå¹¶ä¸”ä¸€ä¸ªæ•°ç»„ä¸Šæœ‰pä¸ªå‡ºå‘çš„ä½ç½®å’Œp ä¸ªåˆ°è¾¾çš„ä½ç½®ï¼Œæ‰€ä»¥åœ¨ä»»æ„ä¸€ä¸ªæ•°ç»„ä¸Šï¼Œå‡ºå‘ç‚¹å’Œåˆ°è¾¾ç‚¹ä¸€å…±æœ€å¤šæœ‰2pä¸ªã€‚å¯¹åº”çš„è¿˜å‰©ä¸‹2pä¸ªå¤§å°ä¸ºO(n/p)çš„å­é—®é¢˜ã€‚`**

   **`å¦‚æœé‡‡ç”¨çº¿æ€§æŸ¥æ‰¾ï¼Œæ·±åº¦å°±æ˜¯O(n/p),æ€»å·¥ä½œé‡ä¸º2p*O(n/p) = O(n),å¦‚æœé‡‡ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Œæ€»å·¥ä½œé‡å°±æ˜¯`$2p \times \frac{n}{p}O(log \frac{n}{p}) = 2n log \frac{n}{p}$**

3. **æ¥ä¸‹æ¥å¸Œæœ›æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜çš„pï¼Œä½¿å¾—ç¬¬ä¸€æ­¥çš„æ€»å·¥ä½œé‡ä¸ºO(n),ç¬¬äºŒæ­¥çš„æ·±åº¦ä¸ºO(log n),`ä¹Ÿå°±æ˜¯é›†æˆä¹‹å‰Binary Searchå’Œserial Rankingçš„ä¼˜ç‚¹ã€‚`äºæ˜¯å¾—åˆ°$p=n/logn$**

## 14.5 Maximum Finding

![image-20240527113513059](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271135119.png)

**`ç¬¬ä¸€ç§æœ€ç®€å•çš„æƒ³æ³•å°±æ˜¯ç±»ä¼¼äºå‰é¢æ±‚å’Œé—®é¢˜çš„åšæ³•ï¼Œæ„é€ ä¸€æ£µäºŒå‰æ ‘ï¼Œåˆå§‹å…ƒç´ ä¸¤ä¸¤åˆ†ç»„æ¯”è¾ƒï¼Œç„¶åé€å±‚ä¸Šé€’ï¼Œæœ€ç»ˆå¾—åˆ°æœ€å¤§å€¼ã€‚è¿™æ ·çš„ç®—æ³•æ·±åº¦ä¸ºO(log n)ï¼Œæ€»å·¥ä½œé‡ä¸ºO(n)ã€‚`**

**`ç¬¬äºŒç§æ–¹æ³•æ˜¯å¹¶è¡Œæ¯”è¾ƒæ¯ä¸€å¯¹å…ƒç´ çš„å€¼ã€‚åªè¦A[i]<A[j],å°±å¾€B[i]ä¸­å†™1ï¼Œæœ€ååªæœ‰æœ€å¤§çš„æ•°ä¸ä¼šè¢«å†™1ã€‚åœ¨å¹¶è¡Œæ¯”è¾ƒæ¯ä¸€å¯¹å…ƒç´ æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å¾€æ•°ç»„B ä¸­è¿›è¡Œå†™å…¥ï¼Œå®é™…ä¸Šæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨å‰é¢æåˆ°çš„CRCW ç­–ç•¥å…è®¸åŒæ—¶å†™å…¥ï¼Œç„¶åæŒ‰common rule å†™å…¥å³å¯ï¼Œå› ä¸ºè¿™é‡Œæ‰€æœ‰çº¿ç¨‹å¾€ä»»æ„ä¸€ä¸ªB[i] åªä¼šå†™å…¥1 è¿™ä¸ªæ•°å­—ï¼Œæ‰€ä»¥å†™å…¥çš„å†…å®¹éƒ½æ˜¯ä¸€æ ·çš„ã€‚`**

**æœ€åå¾—åˆ°æ·±åº¦ä¸ºO(1),æ€»å·¥ä½œé‡ä¸ºO(n^2)**

![image-20240527114430453](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271144519.png)

> **åŒå¯¹æ•°èŒƒå¼**
>
> **åŒå¯¹æ•°èŒƒå¼æ˜¯ä¸€ç§å¯ä»¥äºŒå‰æ ‘çš„æ‰©å±•ã€‚åœ¨å®Œå…¨äºŒå‰æ ‘ä¸­ï¼Œè®¾å¶å­çš„æ•°é‡ä¸ºnï¼Œé‚£ä¹ˆæ ‘é«˜æ˜¯log n çº§åˆ«çš„ï¼Œè¿™é‡ŒåŒå¯¹æ•°åˆ™æ˜¯å¸Œæœ›æ„é€ ä¸€æ£µæ ‘ï¼Œä½¿å¾—æ ‘é«˜æ˜¯log log n çº§åˆ«çš„ã€‚ä¸ºäº†æ„é€ è¿™æ ·ä¸€æ£µæ ‘ï¼Œæˆ‘ä»¬é¦–å…ˆè®¾æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„level ä¸ºä»æ ¹åˆ°è¯¥èŠ‚ç‚¹çš„è·ç¦»ï¼ˆéœ€è¦ç»è¿‡çš„è¾¹æ•°ï¼‰ï¼Œæ ¹çš„level ä¸º0ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ„é€ è¿™æ£µæ ‘å¦‚ä¸‹ï¼š**
>
> 1. **è®¾æŸä¸ªç»“ç‚¹çš„levelä¸ºsï¼Œå½“$s \leq loglogn-1$æ—¶ï¼Œåˆ™å®ƒæœ‰$2^{2^{h-s-1}}ä¸ªå­©å­$**
> 2. **å½“$s = loglogn$æ—¶ï¼Œå®ƒæœ‰2ä¸ªå­©å­ä½œä¸ºæ ‘çš„å¶å­**
>
> ![image-20240530195027929](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405301950972.png)

æ¯ä¸€æ®µçš„é•¿åº¦ä¸º$\sqrt n$,ä¸€å…±æœ‰$\sqrt n$æ®µ

![image-20240527114830853](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271148889.png)

æŠŠæ•°æ®åˆ’åˆ†æˆæ›´å°æ®µï¼Œæ¯ä¸€æ®µçš„é•¿åº¦ä¸ºloglog n

1. å°†æ•°ç»„åˆ†ä¸º$n/ log log n$ä»½ï¼Œå³æ¯ä¸€ä»½çš„å¤§å°ä¸º$log log n$ï¼Œå¦‚PPT ç¬¬20 é¡µï¼›å®é™…ä¸Šæ¯ä¸€ä»½çš„å¤§å°éƒ½å¾ˆå°äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨çº¿æ€§æŸ¥æ‰¾çš„æ–¹å¼æ‰¾åˆ°æ¯ä¸€ä»½çš„æœ€å¤§å€¼ï¼Œåˆ™æ¯ä¸€ä»½çš„æ·±åº¦å’Œå·¥ä½œé‡éƒ½æ˜¯$O(log log n)$çš„ï¼›
2. ç„¶åæˆ‘ä»¬å¯¹ä¸Šé¢æ±‚å‡ºçš„$n/ log log n$ä¸ªæœ€å¤§å€¼ä½¿ç”¨åŒå¯¹æ•°èŒƒå¼çš„ç®—æ³•ã€‚

![image-20240527120646764](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271206796.png)

![image-20240527120703385](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405271207434.png)



## 14.6 ä¹ é¢˜é›†

1. While comparing a serial algorithm with its parallel counterpart, we just concentrate on reducing the work load.

      **`Fï¼Œé™¤äº†work loadè¿˜éœ€è¦å…³æ³¨æ—¶é—´å¤æ‚åº¦ã€‚åˆ†åˆ«å¯¹åº”Wå’ŒT`**

2. To evaluate the Prefix-Sums of a sequence of 16 numbers by the parallel algorithm with Balanced Binary Trees, C(4,1) is found before C(2,2).

      **`è®¡ç®—å‰ç¼€å’Œæ—¶ï¼Œä»ä¸Šå¾€ä¸‹è®¡ç®—ã€‚å¯¹äºsummationé—®é¢˜ï¼ŒB[]æ˜¯ä»ä¸‹å¾€ä¸Šè®¡ç®—çš„`**

3. To evaluate the sum of a sequence of 16 numbers by the parallel algorithm with Balanced Binary Trees, B(1,6) is found before B(2,1).

      **`B[]ä»ä¸‹å¾€ä¸Šè®¡ç®—`**

4. In order to solve the maximum finding problem by a parallel algorithm with$T(n)=O(1)$, we need work load$W(n)=Î©(n^2)$in return.

      **`F.é‡‡ç”¨ Random Samplingï¼Œå°±å¯ä»¥åœ¨$ğ‘Š(ğ‘›)=ğ‘‚(ğ‘›)$ä¸‹å¾—åˆ°ç»“æœã€‚`**

   

5. To solve the Maximum Finding problem with parallel Random Sampling method,$O(n)$processors are required to get$T(n)=O(1)$and$W(n)=O(n)$with very high probability

      **`T`**

6. The prefix-min problem is to find for each *i*, 1â‰¤*i*â‰¤*n*, the smallest element among *A*(1), *A*(2), â‹¯, *A*(*i*). What is the run time and work load for the following algorithm?

      ```cpp
      for i, 1â‰¤iâ‰¤n pardo
      B(0, i) = A(i)
      for h=1 to log(n)
      for i, 1â‰¤iâ‰¤n/2^h pardo
         B(h, i) = min {B(h-1, 2i-1), B(h-1, 2i)}
      for h=log(n) to 0
      for i even, 1â‰¤iâ‰¤n/2^h pardo
         C(h, i) = C(h+1, i/2)
      for i=1 pardo
         C(h, 1) = B(h, 1)
      for i odd, 3â‰¤iâ‰¤n/2^h pardo
         C(h, i) = min {C(h + 1, (i - 1)/2), B(h, i)}
      for i, 1â‰¤iâ‰¤n pardo
      Output C(0, i)
      ```

      ![image-20240530200435587](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405302004633.png)

      **`å‚ç…§æ±‚å‰ç¼€å’Œé—®é¢˜ï¼Œå±‚æ•°ä¸ºlogn,å¯¹åº”çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(logn),æ¯ä¸€ä¸ªç»“ç‚¹çš„å€¼éƒ½éœ€è¦è®¡ç®—ï¼Œå¯¹åº”çš„ä¹Ÿå°±æ˜¯n+n/2+n/4+...+1 = 2n,work loadå°±æ˜¯O(n)`**

7. Which one of the following statements about the Maximum Finding problem is true?

      A.There exists a` serial algorithm` with time complexity being$O(logN)$.

      B.`No parallel algorithm `can solve the problem in *O*(1) time.

      C.When partitioning the problem into sub-problems and solving them in parallel, compared with$\sqrt N$, choosing$loglogN$as the size of each sub-problem can reduce the work load and the worst-case time complexity.

      **D.Parallel random sampling algorithm can run in *O*(1) time and *O*(*N*) work with very high probability.**

      **`Dâˆš`**

      **`å…³äºCé€‰é¡¹ï¼Œpartition by`$\sqrt N$,å¯¹åº”çš„æ—¶é—´å¤æ‚ä¸º$T(N) = O(loglogN)$,å¯¹åº”çš„work loadä¸º$O(NloglogN)$**

      **partition by$loglogN$,å¯¹åº”çš„æ—¶é—´å¤æ‚åº¦ä¸º$T(N) = loglogN$,å¯¹åº”çš„work loadä¸º$O(N)$**

      **`æ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸å˜ï¼Œä½†æ˜¯work loadå˜å°`**

8. Sorting-by-merging is a classic serial algorithm. It can be translated directly into a reasonably efficient parallel algorithm. A recursive description follows.$MERGEâˆ’SORT( A(1), A(2), ..., A(n); B(1), B(2), ..., B(n) )$Assume that$n=2^l$for some integer$lâ‰¥0$

      if n = 1 then return B(1) := A(1)

      else call, in parallel,$MERGEâˆ’SORT( A(1), ..., A(n/2); C(1), ..., C(n/2) )$and

      - $MERGEâˆ’SORT(A(n/2+1), ..., A(n); C(n/2+1), ..., C(n) )$
      - $Merge (C(1),...C(n/2)) \ and \ (C(n/2 + 1),...,C(n))$into$(B(1), B(2), ..., B(n))$with time O(n)

      Then the MERGEâˆ’SORT runs in __ .

      A.$O(nlogn)$work and$O(log^2n)$time

      B$O(nlogn)$work and $O(logn)$time

      C.$O(nlog^2n)$work and $O(log^2n)$time

      D.$O(nlog^2n)$) work and $O(logn)$time

      ![image-20240530201752836](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405302017896.png)

9. Which one of the following statements about the **`Ranking problem`** is true? (Assume that both arrays contain *N* elements.)

      A.There exists a serial algorithm with time complexity being$O(logN)$.

      **`serial algorithmå¯¹åº”çš„æ—¶é—´å¤æ‚åº¦å’Œwork loadéƒ½æ˜¯O(n)`**

      B.Parallel binary search algorithm can solve the problem in$O(1)$time.

      **`binary searchå¯¹åº”çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(logN)`**

      C.When partitioning the problem into sub-problems and solving them in parallel, choosing$O(loglogN)$as the size of each sub-problem can reduce the work load and the worst-case time complexity to$O(logN)$.

      **`åœ¨Maximum Findingé—®é¢˜ä¸­ï¼ŒåŒå¯¹æ•°èŒƒå¼åˆ†å‰²ï¼Œå¯¹åº”çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(loglogN)`**

      **D.There is a parallel algorithm that can run in$O(logN)$time and$O(N)$work.**

      **`Dé€‰é¡¹ï¼Œparallel rankingé›†æˆäºŒåˆ†æœç´¢çš„æ—¶é—´å¤æ‚åº¦O(logN)å’Œé¡ºåºæŸ¥æ‰¾çš„work load O(n)`**

   ![image-20240530202139378](https://zn-typora-image.oss-cn-hangzhou.aliyuncs.com/typora_image/202405302021420.png)
